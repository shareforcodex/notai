<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free notai</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="./icons/notai-192x192.png" type="image/x-icon">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://corsp.suisuy.eu.org?https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>



    <!-- Import CodeMirror from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css" />

    <!-- premitter -->
    <script src="https://cdn.jsdelivr.net/npm/prettier@2.3.2/standalone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prettier@2.3.2/parser-html.js"></script>



</head>

<body>
    <div class="editor-container">

        <div class="sidebar hidden" >
            <div class="sidebar-header">
                <div class="auth-buttons">
                    <button id="logoutBtn" style="display: none;" onclick="window.editor.logout()"><i
                            class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
                <div class="sidebar-actions">
                    <div class="folder-input-container" style="display: none;">
                        <input type="text" id="newFolderInput" placeholder="Folder name">
                        <button id="createFolderBtn"><i class="fas fa-check"></i></button>
                        <button id="cancelFolderBtn"><i class="fas fa-times"></i></button>
                    </div>
                    <button id="newFolderBtn">+</button>
                </div>
            </div>
            <div id="folders"></div>
            <div id="pagesList"></div>
            <div class="sidebar-section">
                <button id="toggleTocBtn" class="sidebar-btn">
                    <i class="fas fa-list"></i> Table of Contents
                </button>
                <div id="tocList" style="display: none;"></div>
            </div>

            <div style="height: 200px;"></div>

        </div>
        <div class="main-content">
            <div class="toolbar">
                <div class="formatting-tools">

                    <button id="toggleSidebar" class="toggle-sidebar-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="dropdown user-settings">
                        <button class="dropbtn"><i class="fas fa-user-cog"></i></button>
                        <div class="dropdown-content">
                            <button id="updateAppBtn"> <i class="fa fa-refresh" aria-hidden="true"></i>
                                Update App v0.2</button>
                            <button id="userProfileBtn"><i class="fas fa-user"></i> Profile</button>
                            <button id="aiSettingsBtn"><i class="fas fa-cog"></i> AI Settings</button>
                            <button id="logoutBtn" onclick="window.editor.logout()"><i class="fas fa-sign-out-alt"></i>
                                Logout</button>
                        </div>
                    </div>

                    <!-- AI Settings Modal -->
                    <div id="aiSettingsModal" class="modal">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h2>AI Tools Settings</h2>
                                <span class="close">&times;</span>
                            </div>
                            <div class="modal-body">
                                <div class="settings-toc">
                                    <h3>Table of Contents</h3>
                                    <ul>
                                        <li><a href="#default-prompts">Default Prompts</a></li>
                                        <li><a href="#custom-ai-tools">Custom AI Tools</a></li>
                                        <li><a href="#models">Models</a></li>
                                    </ul>
                                </div>
                                <div class="settings-section">
                                    <h3 id="default-prompts">Default Prompts</h3>
                                    <div class="prompt-item system-prompt"
                                        style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 4px;">
                                        <label
                                            style="display: block; font-weight: bold; color: #007bff; margin-bottom: 10px;">System
                                            Prompt:</label>
                                        <div style=" gap: 10px; align-items: flex-start;">
                                            <textarea id="systemPrompt"
                                                placeholder="Enter system prompt that will be prepended before all AI messages"
                                                style="width: 100%; min-height: 100px; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: monospace; resize: vertical;"></textarea>
                                            <br>
                                            <button id="resetSystemPrompt" class="reset-btn"
                                                style="padding: 8px 12px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; white-space: nowrap;">
                                                <i class="fas fa-undo"></i> Reset
                                            </button>
                                        </div>
                                        <small class="help-text"
                                            style="display: block; margin-top: 8px; color: #6c757d;">This prompt will be
                                            used as the system message for all AI interactions.<b>if the app broken, try
                                                to reset the system prompt</b></small>
                                    </div>
                                    <p class="help-text">Use {text} in your prompt templates where you want the selected
                                        text inserted.</p>
                                    <div class="prompt-settings">
                                        <div class="prompt-item">
                                            <label>Ask Button:</label>
                                            <textarea class="tool-prompt" id="askPrompt"
                                                placeholder="Enter prompt template"></textarea>
                                        </div>
                                        <div class="prompt-item">
                                            <label>Correct Button:</label>
                                            <textarea class="tool-prompt" id="correctPrompt"
                                                placeholder="Enter prompt template"></textarea>
                                        </div>
                                        <div class="prompt-item">
                                            <label>Translate Button:</label>
                                            <textarea class="tool-prompt" id="translatePrompt"
                                                placeholder="Enter prompt template"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="settings-section">
                                    <h3 id="custom-ai-tools">Custom AI Tools</h3>
                                    <div id="customTools"></div>
                                    <button id="addCustomTool" class="add-tool-btn">
                                        <i class="fas fa-plus"></i> Add Custom Tool
                                    </button>
                                </div>
                                <div class="settings-section">
                                    <h3 id="models">Models</h3>
                                    <small>Provide a Model Name, a unique Model ID, the Model URL (API endpoint), and
                                        optionally an API Key. For consistency, it's recommended to use the same value
                                        for Name and ID.</small>
                                    <div id="modelSettingsContainer"></div>
                                    <button id="addModelBtn" class="add-tool-btn"><i class="fas fa-plus"></i> Add
                                        Model</button>
                                </div>
                                <div class="settings-section">
                                    <h3>Streaming Settings</h3>
                                    <label>
                                        <input type="checkbox" id="enableStreamCheckbox" />
                                        Enable Streaming
                                    </label>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button id="saveSettings" class="save-settings-btn">Save Settings</button>
                            </div>
                        </div>
                    </div>

                    <div class="dropdown">
                        <button class="dropbtn"><i class="fas fa-font"></i> </button>
                        <div class="dropdown-content">
                            <button data-command="bold"><i class="fas fa-bold"></i> Bold</button>
                            <button data-command="italic"><i class="fas fa-italic"></i> Italic</button>
                            <button data-command="h1"><i class="fas fa-heading"></i>1</button>
                            <button data-command="h2"><i class="fas fa-heading"></i>2</button>
                            <button data-command="h3"><i class="fas fa-heading"></i>3</button>
                            <button data-command="underline"><i class="fas fa-underline"></i> Underline</button>
                            <button data-command="strikeThrough"><i class="fas fa-strikethrough"></i> Strike</button>
                            <button data-command="insertUnorderedList"><i class="fas fa-list-ul"></i> Bullet
                                List</button>
                            <button data-command="insertOrderedList"><i class="fas fa-list-ol"></i> Numbered
                                List</button>
                            <button id="plainTextBtn"><i class="fas fa-text-height"></i> Plain Text</button>
                            <div class="color-picker">
                                <i class="fas fa-paint-brush"></i> Text Color
                                <input type="color" id="textColor">
                            </div>
                            <div class="color-picker">
                                <i class="fas fa-fill-drip"></i> Background Color
                                <input type="color" id="bgColor" value="#ffffff">
                            </div>
                        </div>
                    </div>

                    <div class="dropdown">
                        <button class="dropbtn"><i class="fas fa-plus"></i> </button>
                        <div class="dropdown-content">
                            <button id="uploadFileBtn"><i class="fas fa-upload"></i> Upload File</button>
                            <button data-command="createLink"><i class="fas fa-link"></i> Link</button>
                            <button id="insertIframe"><i class="fas fa-window-maximize"></i> Embed webpage</button>
                            <button id="addComment"><i class="fas fa-comment"></i> Add Comment</button>
                        </div>
                    </div>
                    <!-- Comment tooltip -->
                    <div id="commentTooltip" class="comment-tooltip" style="display: none;">
                        <div class="tooltip-header">
                            <button class="close-tooltip"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="comment-content"></div>
                    </div>

                    <button id="addBlockBtn"><i class=""></i>âŠž</button>
                    <button id="viewSourceBtn"><i class="fas fa-code"></i> </button>
                    <button id="toggleEditableBtn" title="Toggle Editor Editability">
                        <i class="fas fa-lock-open"></i>
                    </button>
                    <button id="topbarPinBtn"><i class="fas fa-thumbtack"></i></button>
                    <button id="saveNoteBtn">
                        <i class="fas fa-save"></i>
                        <i class="fas fa-spinner fa-spin" style="display: none;"></i>
                        <span></span>
                    </button>
                </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; background-color: #f5f5f5;">
                <div id="noteTitle" class="note-title" contenteditable="true" placeholder="Untitled"></div>
                <div id="recentNotes" class="recent-notes"
                    style="display: inline-flex; align-items: center; margin-left: 10px;"></div>
            </div>
            <div id="editor" class="editor" contenteditable="true">
                <div class="block">
                    loading...
                </div>
            </div>
            <textarea id="sourceView" class="editor source-view" style="display: none;"></textarea>
            <div id="aiToolbar" class="ai-toolbar">
                <div class="ai-toolbar-content">
                    <div class="ai-model-selects">
                        <div class="custom-dropdown">
                            <button class="model-select-btn" id="modelBtn1">GPT-4O</button>
                            <div class="model-options">
                                <button data-value="gpt-4o">GPT-4O</button>
                                <button data-value="gpt-4o-mini">GPT-4O Mini</button>
                                <button data-value="Meta-Llama-3.1-405B-Instruct">Llama 3.1 405B</button>
                                <button data-value="Llama-3.2-90B-Vision-Instruct">Llama 3.2 90B</button>
                                <button data-value="Mistral-large">Mistral Large</button>
                            </div>
                        </div>
                        <div class="custom-dropdown">
                            <button class="model-select-btn" id="modelBtn2">No Second Model</button>
                            <div class="model-options">
                                <button data-value="none">No Second Model</button>
                                <button data-value="gpt-4o">GPT-4O</button>
                                <button data-value="gpt-4o-mini">GPT-4O Mini</button>
                                <button data-value="Meta-Llama-3.1-405B-Instruct">Llama 3.1 405B</button>
                                <button data-value="Mistral-large">Mistral Large</button>
                            </div>
                        </div>
                        <div class="custom-dropdown">
                            <button class="model-select-btn" id="modelBtn3">No Third Model</button>
                            <div class="model-options">
                                <button data-value="none">No Third Model</button>
                                <button data-value="gpt-4o">GPT-4O</button>
                                <button data-value="gpt-4o-mini">GPT-4O Mini</button>
                                <button data-value="Meta-Llama-3.1-405B-Instruct">Llama 3.1 405B</button>
                                <button data-value="Mistral-large">Mistral Large</button>
                            </div>
                        </div>
                    </div>
                    <div class="ai-actions">
                        <button data-ai-action="ask"><i class="fas fa-question-circle"></i> Ask</button>
                        <button data-ai-action="correct"><i class="fas fa-check-circle"></i> Correct</button>
                        <button data-ai-action="translate"><i class="fas fa-language"></i> Translate</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <button id="quickAskBtn" class="quick-ask-btn">
        <i class="fas fa-paper-plane"></i>
    </button>
    <script src="script.js"></script>
    <div id="toastContainer" class="toast-container"></div>
    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Profile</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>User ID: <span id="currentUserId"></span></p>
            </div>
            <div class="modal-footer">
                <button class="close-profile-btn">Close</button>
            </div>
        </div>
    </div>
    <div id="loadingSpinner" class="spinner" style="display: none;">
        <div class="double-bounce1"></div>
        <div class="double-bounce2"></div>
    </div>
    <button id="codeCopyBtn" class="code-copy-btn" style="display: none;">
        <i class="fas fa-copy"></i>
    </button>
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <input type="file" id="fileInput" style="display: none;" accept="*/*">
                <button id="selectFileBtn" class="upload-container-btn">Select File</button>
                <button id="uploadBtn" class="upload-container-btn">Upload</button>
                <button class="close upload-container-btn">Close</button>
            </div>
            <div class="modal-body">
                

                <div class="media-capture-controls">

                    <div class="capture-buttons">
                        <button id="capturePhotoBtn" class="capture-btn">
                            <i class="fas fa-camera"></i>
                        </button>
                        <button id="shootPhotoBtn" class="capture-btn" style="display: none;">
                            <i class="fas fa-camera"></i>
                        </button>
                        <button id="captureVideoBtn" class="capture-btn">
                            <i class="fas fa-video"></i>
                        </button>
                        <button id="captureAudioBtn" class="capture-btn">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    <div class="device-selectors">
                        <select id="videoDevices" class="device-select">
                            <option value="">Select Camera</option>
                        </select>
                        <select id="audioDevices" class="device-select">
                            <option value="">Select Microphone</option>
                        </select>
                    </div>
                    <div id="mediaPreview">
                        <video id="videoPreview" autoplay playsinline style="display: none;"></video>
                        <canvas id="photoCanvas" style="display: none;"></canvas>
                        <div id="audioRecordingControls" style="display: none;">
                            <span id="recordingTime">00:00</span>
                            <button id="stopRecordingBtn" style="display: none;">Stop Recording</button>
                        </div>
                    </div>
                </div>

                <div id="previewArea" style="display: none; margin-top: 20px;">
                    <h3>Preview:</h3>
                    <div id="filePreview" style="max-width: 100%; margin-top: 10px;"></div>
                </div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js').then(registration => {
                    console.log('Service Worker registered with scope:', registration.scope);
                }).catch(error => {
                    console.error('Service Worker registration failed:', error);
                });
            });
        }
    </script>
</body>

</html>